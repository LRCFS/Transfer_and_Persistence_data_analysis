---
title: "Transfer and Persistence Data Analysis"
author: "Christian Cole"
date: "22/11/2019"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)
# libraries
library(readxl)
library(plyr)
library(ggplot2)
library(dplyr)
```

```{r functions}
# functions
## Gives count, mean, standard deviation, standard error of the mean, and confidence interval (default 95%).
##   data: a data frame.
##   measurevar: the name of a column that contains the variable to be summariezed
##   groupvars: a vector containing names of columns that contain grouping variables
##   na.rm: a boolean that indicates whether to ignore NA's
##   conf.interval: the percent range of the confidence interval (default is 95%)
summarySE <- function(data=NULL, measurevar, groupvars=NULL, na.rm=FALSE,
                      conf.interval=.95, .drop=TRUE) {
    # New version of length which can handle NA's: if na.rm==T, don't count them
    length2 <- function (x, na.rm=FALSE) {
        if (na.rm) sum(!is.na(x))
        else       length(x)
    }

    # This does the summary. For each group's data frame, return a vector with
    # N, mean, and sd
    datac <- ddply(data, groupvars, .drop=.drop,
      .fun = function(xx, col) {
        c(N    = length2(xx[[col]], na.rm=na.rm),
          mean = mean   (xx[[col]], na.rm=na.rm),
          sd   = sd     (xx[[col]], na.rm=na.rm)
        )
      },
      measurevar
    )

    # Rename the "mean" column    
    datac <- plyr::rename(datac, c("mean" = measurevar))

    datac$se <- datac$sd / sqrt(datac$N)  # Calculate standard error of the mean

    # Confidence interval multiplier for standard error
    # Calculate t-statistic for confidence interval: 
    # e.g., if conf.interval is .95, use .975 (above/below), and use df=N-1
    ciMult <- qt(conf.interval/2 + .5, datac$N-1)
    datac$ci <- datac$se * ciMult

    return(datac)
}

## function to convert a (character) vector of 
## numbers into a factor ordered numerically
numericFactorOrder <- function(x) {
    
  u = unique(x)
  new.levels = u[order(as.numeric(u))]
  x = factor(x, levels=new.levels)
  return(x)
  
}

```


## Plotting of Transfer Experiment Results - for ML

Starting with the simplest dataset e.g. with few samples and combinations. Using the combined spreadsheet "20191030DatasetPaper.xlsx" as all the data should be in there and is the source of the paper's figures.

The Transfer experiments are defined by the "Time" column is "0" meaning there has been no Persistence performed yet. By selecting only those that value we can ignore the Persistence experiments (for the time being).

```{r readML}
# Read in ML's data
my.dat = read_xlsx("dat/20191030DatasetPaper.xlsx", sheet = "DataMl")

# only use the transfer experiments for Groups 1 & 2. Groups 3-6 are not 
# clear in what they are and don't fit with the rest. Mostly Persistence?
# TODO - deal with Groups 3-6 later
transfer.dat = my.dat %>% filter(Time == "00000" & Group %in% c(1,2)) %>% select(c("Substrate", "ActivityID", "ObsType", "Count", "Mass", "Duration", "Group", "Repeat")) 

knitr::kable(head(transfer.dat, 20), caption = "'Head' of ML's Transfer Data")

```

```{r mungeML}

# fix column types
transfer.dat$Count = as.numeric(transfer.dat$Count)
transfer.dat$Group = as.character(transfer.dat$Group)
transfer.dat$Repeat = as.character(transfer.dat$Repeat)

# add a photoID column to keep track of which datapoint is which
photo.id = rep(paste0("P", seq(1:5)), as.integer(nrow(transfer.dat)/5+1))
transfer.dat = data.frame(PhotoID = photo.id[1:nrow(transfer.dat)], transfer.dat)

# split out each set of photos...
p1 = transfer.dat %>% filter(PhotoID == "P1") %>% select(Mass,Duration,Group,Repeat,Count)
p2 = transfer.dat %>% filter(PhotoID == "P2") %>% select(Mass,Duration,Group,Repeat,Count)
p3 = transfer.dat %>% filter(PhotoID == "P3") %>% select(Mass,Duration,Group,Repeat,Count)
p4 = transfer.dat %>% filter(PhotoID == "P4") %>% select(Mass,Duration,Group,Repeat,Count)
p5 = transfer.dat %>% filter(PhotoID == "P5") %>% select(Mass,Duration,Group,Repeat,Count)

# ...and merge
merge.dat = data.frame(p1, p2$Count, p3$Count, p4$Count, p5$Count)
names(merge.dat) = c("Mass","Duration","Group","Repeat","P1","P2","P3","P4","P5")

# calculate the Transfer Ratios and Efficiencies
# NB: the summarise() function can be problematic here, if plyr is loaded
#     after dplyr. Check that first if this stops working.
final.dat = merge.dat %>% group_by(Mass, Duration, Group, Repeat) %>% summarise(Donor = P3 - P1, Receiver = P5 - P2, Donor_post = P3 - P4) %>% mutate(Ratio = Receiver/Donor, Efficiency = Receiver/Donor_post)

summ.dat = summarySE(final.dat, measurevar = "Ratio", groupvars = c("Group"))

knitr::kable(summ.dat, caption = "Summary Data for ML Transfer Ratios")
```

```{r plotML}

ggplot(summ.dat, aes(x = Group, y = Ratio)) + 
  geom_point(size=2.2) +
  geom_errorbar(aes(ymin = Ratio-se, ymax = Ratio+se), width = 0.08) +
  geom_point(colour = "white") +
  scale_x_discrete(labels = c("Wool", "Nylon")) +
  labs(title = "Analysis of Transfer Ratios",
       x = "Receiver Material",
       y = "Transfer Ratio")

```

```{r alldat}

# start df of all ratio data for comparison

all.ratio = summ.dat
all.ratio = all.ratio[, -1]
all.ratio = cbind(Name = rep("ML", 2), Mass = rep(1000,2), TransferTime = rep(60,2), Substrate = c("Wool01", "Nylo01"), all.ratio)


```

## Read SD Data

```{r readSD}
# Read in SD's data
my.dat = read_xlsx("dat/20191030DatasetPaper.xlsx", sheet = "DataSd", trim_ws = TRUE)

# only use the transfer experiments for Groups 8-22. Groups 1-7 have no 
# count data and group 23 is incomplete, only one replicate
# TODO - deal with Groups 3-6 later
transfer.dat = my.dat %>% filter(Time == 0 & Group > 8 & Group < 23) %>% select(c("Substrate", "ActivityID", "ObsType", "Count", "Mass", "Duration", "Group", "Repeat")) 

knitr::kable(head(transfer.dat, 20), caption = "'Head' of SD's Transfer Data")

```
```{r mungeSD}

# fix column types
transfer.dat$Count = as.numeric(transfer.dat$Count)
transfer.dat$Duration = as.numeric(transfer.dat$Duration)
transfer.dat$Mass = as.numeric(transfer.dat$Mass)
transfer.dat$Group = as.character(transfer.dat$Group)
transfer.dat$Repeat = as.character(transfer.dat$Repeat)

# rename Denm01 to Deni01 to match others
transfer.dat[transfer.dat$Substrate == "Denm01", 1] <- "Deni01"

# add a photoID column to keep track of which datapoint is which
photo.id = rep(paste0("P", seq(1:5)), as.integer(nrow(transfer.dat)/5+1))
transfer.dat = data.frame(PhotoID = photo.id[1:nrow(transfer.dat)], transfer.dat)

# split out each set of photos...
p1 = transfer.dat %>% filter(PhotoID == "P1") %>% select(Mass,Duration,Substrate,Group,Repeat,Count)
p2 = transfer.dat %>% filter(PhotoID == "P2") %>% select(Mass,Duration,Substrate,Group,Repeat,Count)
p3 = transfer.dat %>% filter(PhotoID == "P3") %>% select(Mass,Duration,Substrate,Group,Repeat,Count)
p4 = transfer.dat %>% filter(PhotoID == "P4") %>% select(Mass,Duration,Substrate,Group,Repeat,Count)
p5 = transfer.dat %>% filter(PhotoID == "P5") %>% select(Mass,Duration,Substrate,Group,Repeat,Count)

# ...and merge
merge.dat = data.frame(p5[,c("Mass","Duration","Substrate","Group","Repeat")], p1$Count, p2$Count, p3$Count, p4$Count, p5$Count)
names(merge.dat) = c("Mass","TransferTime","Substrate","Group","Repeat","P1","P2","P3","P4","P5")

# calculate the Transfer Ratios and Efficiencies
# NB: the summarise() function can be problematic here, if plyr is loaded
#     after dplyr. Check that first if this stops working.
final.dat = merge.dat %>% group_by(Mass, TransferTime, Substrate, Repeat) %>% summarise(Donor = P3 - P1, Receiver = P5 - P2, Donor_post = P3 - P4) %>% mutate(Ratio = Receiver/Donor, Efficiency = Receiver/Donor_post)

ratio.dat = summarySE(final.dat, measurevar = "Ratio", groupvars = c("Mass", "TransferTime", "Substrate"))
ratio.dat = cbind(Name = rep("SD", nrow(ratio.dat)), ratio.dat)
all.ratio = rbind(all.ratio, ratio.dat)



knitr::kable(ratio.dat, caption = "Summary Data for ML Transfer Ratios")
```
```{r plotSD}

ggplot(ratio.dat, aes(x = numericFactorOrder(TransferTime), y = Ratio)) + 
  geom_point(size=2.2) +
  geom_errorbar(aes(ymin = Ratio-se, ymax = Ratio+se), width = 0.08) +
  geom_point(colour = "white") +
  labs(title = "Analysis of Transfer Ratios",
       x = "Receiver Material",
       y = "Transfer Ratio") +
  facet_grid(numericFactorOrder(Mass) ~ Substrate)


```

## Read BH Data

In trying to replicate the above for BH's data, I found that the "Time" column didn't make sense (an incrementing value per row) so from now on will use the cleaned data which was used for the file-renamer.

```{r readBh}
# Read in Bh's data
my.dat = read_xlsx("dat/NorBhCleanDataset.xlsx", sheet = "Data", trim_ws = TRUE, col_types = "text")

# Fix the column name for Time - seems to have extra spaces
my.dat = rename(my.dat, Mass = `Mass (g)`)
my.dat = rename(my.dat, TransferTime = `TransferTime (s)`)
my.dat = rename(my.dat, PersistenceTime = `PersistenceTime (min)`)
#colnames(my.dat)

# only use the Transfer data (PersistenceTime == "0") 
transfer.dat = my.dat %>% filter(PersistenceTime == 0) %>% select(c("Substrate", "ObservationType", "Count", "Mass", "TransferTime", "Experiment", "Replicate")) 

knitr::kable(head(transfer.dat,20), caption = "'Head' of BH's Transfer Data")

```
```{r mungeBH}
# fix column types
transfer.dat$Count = as.numeric(transfer.dat$Count)
transfer.dat$Experiment = as.character(transfer.dat$Experiment)
transfer.dat$Replicate = as.character(transfer.dat$Replicate)

# add a photoID column to keep track of which datapoint is which
photo.id = rep(paste0("P", seq(1:5)), as.integer(nrow(transfer.dat)/5+1))
transfer.dat = data.frame(PhotoID = photo.id[1:nrow(transfer.dat)], transfer.dat)

# split out each set of photos...
p1 = transfer.dat %>% filter(PhotoID == "P1") %>% select(Mass,TransferTime,Substrate,Experiment,Replicate,Count)
p2 = transfer.dat %>% filter(PhotoID == "P2") %>% select(Mass,TransferTime,Substrate,Experiment,Replicate,Count)
p3 = transfer.dat %>% filter(PhotoID == "P3") %>% select(Mass,TransferTime,Substrate,Experiment,Replicate,Count)
p4 = transfer.dat %>% filter(PhotoID == "P4") %>% select(Mass,TransferTime,Substrate,Experiment,Replicate,Count)
p5 = transfer.dat %>% filter(PhotoID == "P5") %>% select(Mass,TransferTime,Substrate,Experiment,Replicate,Count)

# ...and merge
merge.dat = data.frame(p5[,c("Mass","TransferTime","Substrate","Experiment","Replicate")], p1$Count, p2$Count, p3$Count, p4$Count, p5$Count)
names(merge.dat) = c("Mass","TransferTime","Substrate","Experiment","Replicate","P1","P2","P3","P4","P5")

# calculate the Transfer Ratios and Efficiencies
# NB: the summarise() function can be problematic here, if plyr is loaded
#     after dplyr. Check that first if this stops working.
final.dat = merge.dat %>% group_by(Mass, TransferTime, Substrate, Replicate) %>% summarise(Donor = P3 - P1, Receiver = P5 - P2, Donor_post = P3 - P4) %>% mutate(Ratio = Receiver/Donor, Efficiency = Receiver/Donor_post)

ratio.dat = summarySE(final.dat, measurevar = "Ratio", groupvars = c("Mass","TransferTime","Substrate"))
ratio.dat = cbind(Name = rep("BH", nrow(ratio.dat)), ratio.dat)
all.ratio = rbind(all.ratio, ratio.dat)

knitr::kable(ratio.dat, caption = "Summary Data for BH Transfer Ratios")
```
```{r plottBH}

ggplot(ratio.dat, aes(x = numericFactorOrder(TransferTime), y = Ratio)) + 
  geom_point(size=1) +
  geom_errorbar(aes(ymin = Ratio-se, ymax = Ratio+se), width = 0.08) +
  geom_point(colour = "white", size = 0.7) +
#  scale_x_discrete(labels = c("Wool", "Nylon")) +
  labs(title = "Analysis of Transfer Ratio",
       x = "Transfer Time (s)",
       y = "Transfer Ratio") +
  facet_grid(numericFactorOrder(Mass) ~ Substrate)


```
```{r ploteBH}

eff.dat = summarySE(final.dat, measurevar = "Efficiency", groupvars = c("Mass","TransferTime","Substrate"))

eff.dat
ggplot(eff.dat, aes(x = numericFactorOrder(TransferTime), y = Efficiency)) + 
  geom_point(size=1) +
  geom_errorbar(aes(ymin = Efficiency-se, ymax = Efficiency+se), width = 0.08) +
  geom_point(colour = "white", size = 0.7) +
#  scale_x_discrete(labels = c("Wool", "Nylon")) +
  labs(title = "Analysis of Transfer Efficiency",
       x = "Transfer Time (s)",
       y = "Efficiency") +
  facet_grid(numericFactorOrder(Mass) ~ Substrate)


```

## SG Data


```{r readSg}
# Read in Sg's data
my.dat = read_xlsx("dat/StrSgCleanDataset.xlsx", sheet = "Data", trim_ws = TRUE, col_types = "text")

# Fix the column name for Time - seems to have extra spaces
my.dat = rename(my.dat, Mass = `Mass (g)`)
my.dat = rename(my.dat, TransferTime = `TransferTime (s)`)
my.dat = rename(my.dat, PersistenceTime = `PersistenceTime (min)`)
#colnames(my.dat)

# only use the Transfer data (PersistenceTime == "0") 
transfer.dat = my.dat %>% filter(PersistenceTime == 0) %>% select(c("Substrate", "ObservationType", "Count", "Mass", "TransferTime", "Experiment", "Replicate"))

# also remove expt 16 as it is incomplete
transfer.dat = transfer.dat[as.numeric(transfer.dat$Experiment) < 16,]

knitr::kable(head(transfer.dat,20), caption = "'Head' of SG's Transfer Data")

```


```{r mungeSG}
# fix column types
transfer.dat$Count = as.numeric(transfer.dat$Count)
transfer.dat$Experiment = as.character(transfer.dat$Experiment)
transfer.dat$Replicate = as.character(transfer.dat$Replicate)

# add a photoID column to keep track of which datapoint is which
photo.id = rep(paste0("P", seq(1:5)), as.integer(nrow(transfer.dat)/5+1))
transfer.dat = data.frame(PhotoID = photo.id[1:nrow(transfer.dat)], transfer.dat)

# split out each set of photos...
p1 = transfer.dat %>% filter(PhotoID == "P1") %>% select(Mass,TransferTime,Substrate,Experiment,Replicate,Count)
p2 = transfer.dat %>% filter(PhotoID == "P2") %>% select(Mass,TransferTime,Substrate,Experiment,Replicate,Count)
p3 = transfer.dat %>% filter(PhotoID == "P3") %>% select(Mass,TransferTime,Substrate,Experiment,Replicate,Count)
p4 = transfer.dat %>% filter(PhotoID == "P4") %>% select(Mass,TransferTime,Substrate,Experiment,Replicate,Count)
p5 = transfer.dat %>% filter(PhotoID == "P5") %>% select(Mass,TransferTime,Substrate,Experiment,Replicate,Count)

# ...and merge
merge.dat = data.frame(p5[,c("Mass","TransferTime","Substrate","Experiment","Replicate")], p1$Count, p2$Count, p3$Count, p4$Count, p5$Count)
names(merge.dat) = c("Mass","TransferTime","Substrate","Experiment","Replicate","P1","P2","P3","P4","P5")

# calculate the Transfer Ratios and Efficiencies
# NB: the summarise() function can be problematic here, if plyr is loaded
#     after dplyr. Check that first if this stops working.
final.dat = merge.dat %>% group_by(Mass, TransferTime, Substrate, Replicate) %>% summarise(Donor = P3 - P1, Receiver = P5 - P2, Donor_post = P3 - P4) %>% mutate(Ratio = Receiver/Donor, Efficiency = Receiver/Donor_post)

ratio.dat = summarySE(final.dat, measurevar = "Ratio", groupvars = c("Mass","TransferTime","Substrate"))
ratio.dat = cbind(Name = rep("SG", nrow(ratio.dat)), ratio.dat)
all.ratio = rbind(all.ratio, ratio.dat)

knitr::kable(ratio.dat, caption = "Summary Data for SG Transfer Ratios")
```

```{r plottSG}

ggplot(ratio.dat, aes(x = numericFactorOrder(TransferTime), y = Ratio)) + 
  geom_point(size=1) +
  geom_errorbar(aes(ymin = Ratio-se, ymax = Ratio+se), width = 0.08) +
  geom_point(colour = "white", size = 0.7) +
#  scale_x_discrete(labels = c("Wool", "Nylon")) +
  labs(title = "Analysis of Transfer Ratio",
       x = "Transfer Time (s)",
       y = "Transfer Ratio") +
  facet_grid(numericFactorOrder(Mass) ~ Substrate)


```

```{r ploteSG}

eff.dat = summarySE(final.dat, measurevar = "Efficiency", groupvars = c("Mass","TransferTime","Substrate"))

ggplot(eff.dat, aes(x = numericFactorOrder(TransferTime), y = Efficiency)) + 
  geom_point(size=1) +
  geom_errorbar(aes(ymin = Efficiency-se, ymax = Efficiency+se), width = 0.08) +
  geom_point(colour = "white", size = 0.7) +
#  scale_x_discrete(labels = c("Wool", "Nylon")) +
  labs(title = "Analysis of Transfer Efficiency",
       x = "Transfer Time (s)",
       y = "Efficiency") +
  facet_grid(numericFactorOrder(Mass) ~ Substrate)


```

## EM Data

```{r readEm}
# Read in Em's data
my.dat = read_xlsx("dat/StrEmCleanDataset.xlsx", sheet = "DataEm", trim_ws = TRUE, col_types = "text")

# Fix the column name for Time - seems to have extra spaces
my.dat = rename(my.dat, Mass = `Mass (g)`)
my.dat = rename(my.dat, TransferTime = `TransferTime (s)`)
my.dat = rename(my.dat, PersistenceTime = `PersistenceTime (min)`)
#colnames(my.dat)

# only use the Transfer data (PersistenceTime == "0") 
transfer.dat = my.dat %>% filter(PersistenceTime == 0) %>% select(c("Substrate", "ObservationType", "Count", "Mass", "TransferTime", "Experiment", "Replicate"))

# also remove expt 16 as it is incomplete
transfer.dat = transfer.dat[as.numeric(transfer.dat$Experiment) < 16,]

knitr::kable(head(transfer.dat, 20), caption = "'Head' of EM's Transfer Data")

```

```{r mungeEM}
# fix column types
transfer.dat$Count = as.numeric(transfer.dat$Count)
transfer.dat$Experiment = as.character(transfer.dat$Experiment)
transfer.dat$Replicate = as.character(transfer.dat$Replicate)

# add a photoID column to keep track of which datapoint is which
photo.id = rep(paste0("P", seq(1:5)), as.integer(nrow(transfer.dat)/5+1))
transfer.dat = data.frame(PhotoID = photo.id[1:nrow(transfer.dat)], transfer.dat)

# split out each set of photos...
p1 = transfer.dat %>% filter(PhotoID == "P1") %>% select(Mass,TransferTime,Substrate,Experiment,Replicate,Count)
p2 = transfer.dat %>% filter(PhotoID == "P2") %>% select(Mass,TransferTime,Substrate,Experiment,Replicate,Count)
p3 = transfer.dat %>% filter(PhotoID == "P3") %>% select(Mass,TransferTime,Substrate,Experiment,Replicate,Count)
p4 = transfer.dat %>% filter(PhotoID == "P4") %>% select(Mass,TransferTime,Substrate,Experiment,Replicate,Count)
p5 = transfer.dat %>% filter(PhotoID == "P5") %>% select(Mass,TransferTime,Substrate,Experiment,Replicate,Count)

# ...and merge
merge.dat = data.frame(p5[,c("Mass","TransferTime","Substrate","Experiment","Replicate")], p1$Count, p2$Count, p3$Count, p4$Count, p5$Count)
names(merge.dat) = c("Mass","TransferTime","Substrate","Experiment","Replicate","P1","P2","P3","P4","P5")

# calculate the Transfer Ratios and Efficiencies
# NB: the summarise() function can be problematic here, if plyr is loaded
#     after dplyr. Check that first if this stops working.
final.dat = merge.dat %>% group_by(Mass, TransferTime, Experiment, Substrate, Replicate) %>% summarise(Donor = P3 - P1, Receiver = P5 - P2, Donor_post = P3 - P4) %>% mutate(Ratio = Receiver/Donor, Efficiency = Receiver/Donor_post)

ratio.dat = summarySE(final.dat, measurevar = "Ratio", groupvars = c("Mass","TransferTime","Substrate"))
ratio.dat = cbind(Name = rep("EM", nrow(ratio.dat)), ratio.dat)
all.ratio = rbind(all.ratio, ratio.dat)


knitr::kable(ratio.dat, caption = "Summary Data for EM Transfer Ratios")
```

Added an extra column for "Experiment" in addition to "Substrate" here as there seems to be too many replicates?? Need to investigate further.

```{r plottEM}

ggplot(ratio.dat, aes(x = numericFactorOrder(TransferTime), y = Ratio)) + 
  geom_point(size=1) +
  geom_errorbar(aes(ymin = Ratio-se, ymax = Ratio+se), width = 0.08) +
  geom_point(colour = "white", size = 0.7) +
#  scale_x_discrete(labels = c("Wool", "Nylon")) +
  labs(title = "Analysis of Transfer Ratio",
       x = "Transfer Time (s)",
       y = "Transfer Ratio") +
  facet_grid(numericFactorOrder(Mass) ~ Substrate)


```
```{r ploteEM}

eff.dat = summarySE(final.dat, measurevar = "Efficiency", groupvars = c("Mass","TransferTime","Substrate"))

eff.dat
ggplot(eff.dat, aes(x = numericFactorOrder(TransferTime), y = Efficiency)) + 
  geom_point(size=1) +
  geom_errorbar(aes(ymin = Efficiency-se, ymax = Efficiency+se), width = 0.08) +
  geom_point(colour = "white", size = 0.7) +
#  scale_x_discrete(labels = c("Wool", "Nylon")) +
  labs(title = "Analysis of Transfer Efficiency",
       x = "Transfer Time (s)",
       y = "Efficiency") +
  facet_grid(numericFactorOrder(Mass) ~ Substrate)


```

## Combined Analysis

For the purposes of the paper let's look at the 1000g set for wool and nylon separately.

```{r plotwool}

wool.dat = all.ratio %>% filter(Mass == 1000 & Substrate == "Wool01")
wool.dat

ggplot(wool.dat, aes(x=numericFactorOrder(TransferTime), y = Ratio, group = Name, colour = Name, shape=Name)) +
  geom_point(position = position_dodge(0.3)) +
  geom_errorbar(aes(ymin = Ratio-se, ymax = Ratio+se), width = 0.08, position = position_dodge(0.3)) +
  labs(title = "Transfer Ratio for Cotton to Wool",
       subtitle = "For 1000g Mass",
       x = "Transfer Time (s)")

```
```{r plotnylon}

nylon.dat = all.ratio %>% filter(Mass == 1000 & Substrate == "Nylo01")
nylon.dat

ggplot(nylon.dat, aes(x=numericFactorOrder(TransferTime), y = Ratio, group = Name, colour = Name, shape=Name)) +
  geom_point(position = position_dodge(0.3)) +
  geom_errorbar(aes(ymin = Ratio-se, ymax = Ratio+se), width = 0.08, position = position_dodge(0.3)) +
  labs(title = "Transfer Ratio for Cotton to Nylon",
       subtitle = "For 1000g Mass",
       x = "Transfer Time (s)")

```
```{r plot60w}

wool60.dat = all.ratio %>% filter(TransferTime == 60 & Substrate == "Wool01")
wool60.dat

ggplot(wool60.dat, aes(x=numericFactorOrder(Mass), y = Ratio, group = Name, colour = Name, shape=Name)) +
  geom_point(position = position_dodge(0.3)) +
  geom_errorbar(aes(ymin = Ratio-se, ymax = Ratio+se), width = 0.08, position = position_dodge(0.3)) +
  labs(title = "Transfer Ratio for Cotton to Wool",
       subtitle = "For 60s Transfer Time",
       x = "Mass (g)")

```
```{r plot60n}

nylon60.dat = all.ratio %>% filter(TransferTime == 60 & Substrate == "Nylo01")
nylon60.dat

ggplot(nylon60.dat, aes(x=numericFactorOrder(Mass), y = Ratio, group = Name, colour = Name, shape=Name)) +
  geom_point(position = position_dodge(0.3)) +
  geom_errorbar(aes(ymin = Ratio-se, ymax = Ratio+se), width = 0.08, position = position_dodge(0.3)) +
  labs(title = "Transfer Ratio for Cotton to Nylon",
       subtitle = "For 60s Transfer Time",
       x = "Mass (g)")

```

```{r plotallratio}

ggplot(all.ratio, aes(x = numericFactorOrder(TransferTime), y = Ratio, group = Name, colour = Name)) + 
  geom_point(size=1, position = position_dodge(0.2)) +
  geom_errorbar(aes(ymin = Ratio-se, ymax = Ratio+se), width = 0.08, position = position_dodge(0.2)) +
#  geom_point(colour = "white", size = 0.7, position = position_dodge(0.2)) +
#  scale_x_discrete(labels = c("Wool", "Nylon")) +
  labs(title = "Analysis of Transfer Ratio",
       x = "Transfer Time (s)",
       y = "Transfer Ratio") +
  facet_grid(numericFactorOrder(Mass) ~ Substrate)


```


